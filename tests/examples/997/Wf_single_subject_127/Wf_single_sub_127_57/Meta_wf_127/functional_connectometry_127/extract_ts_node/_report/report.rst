Node: Meta_wf_127 (functional_connectometry_127 (extract_ts_node (utility)
==========================================================================


 Hierarchy : Wf_single_sub_127_57.Meta_wf_127.functional_connectometry_127.extract_ts_node
 Exec ID : extract_ts_node


Original Inputs
---------------


* ID : 127
* atlas_select : atlas_aal
* block_size : None
* c_boot : 0
* conf : None
* coords : [(-8.320185614849194, -26.78731631863883, 69.02088167053364), (7.126794258373209, -32.942583732057415, 66.79186602870814), (-25.25536480686695, -21.963519313304715, -11.384120171673821), (28.94503171247358, -20.991543340380545, -11.577167019027485), (-45.890075128509295, 28.666666666666657, 12.582839066824832), (50.061366806136675, 28.901906090190607, 12.817294281729431), (-55.86887899635775, -34.98421691622825, -3.584783488466215), (57.15990020412792, -38.565661147652534, -2.7752324790201897), (-21.492842535787318, -17.29243353783231, -21.918200408997954), (25.148409893992934, -16.300353356890454, -21.743816254416963), (-36.24023668639053, 29.49230769230769, -13.459171597633137), (40.910369068541314, 30.99472759226714, -13.258347978910372), (-36.602666666666664, 13.354666666666674, -35.40533333333333), (43.981418918918905, 13.275337837837839, -33.554054054054056), (-31.39514731369151, -41.36221837088388, -21.61525129982669), (33.6637519872814, -40.16057233704292, -21.546899841017485), (-47.378542510121456, -9.751012145748987, 12.635627530364374), (52.381667918858, -7.537190082644628, 13.32982719759579), (-6.817406143344712, 48.22696245733789, 28.805460750853243), (8.75070290534208, 49.52858481724462, 28.92689784442362), (-35.38532462543219, -67.94314252785247, -30.262773722627735), (38.214501510574024, -68.37160120845923, -30.849697885196377), (-6.527363184079604, 52.25538971807629, -8.762852404643446), (7.834112149532714, 50.406542056074755, -8.516355140186917), (-18.79777158774374, 33.41782729805013, 40.99442896935933), (21.604834731129742, 29.909718796250615, 42.513073507646766), (-28.56786102062975, -74.37133550488599, -39.69055374592834), (32.673594709494566, -70.39678790741615, -41.20170051960321), (-43.10666121781774, -47.01920719248059, 45.42296689824275), (46.291449814126395, -47.58810408921933, 48.19182156133829), (-8.117647058823536, -38.367647058823536, -19.779411764705884), (13.062801932367151, -35.710144927536234, -20.59903381642512), (-16.824506749740394, 45.919003115264786, -14.718587746625133), (18.17853560682046, 46.61785356068205, -15.494483450351055), (-56.146496815286625, -34.93630573248407, 29.119426751592357), (57.27116066903193, -32.82209832742018, 33.13228585909782), (-14.343111111111114, -44.66311111111111, -18.261333333333333), (17.888501742160273, -44.16492450638792, -19.354239256678284), (-44.424914675767916, -62.08532423208191, 34.27815699658703), (45.22831050228311, -61.23858447488584, 37.31506849315069), (-32.639288997854734, -81.99387067116152, 14.788844621513945), (37.10644391408114, -81.00143198090691, 18.095465393794754), (-22.525383707201883, -60.25855962219599, -23.480519480519483), (25.429526462395543, -59.53760445682451, -24.94038997214485), (-11.767151767151773, 9.723492723492711, 8.070686070686065), (14.494969818913475, 10.776659959758547, 8.148893360160969), (-31.585616438356162, -61.078767123287676, -46.763698630136986), (33.928838951310865, -64.40823970037454, -49.760299625468164), (-6.809734513274336, 3.129424778761063, 60.535398230088504), (8.246309574019406, -1.0932096161956935, 60.512863770560955), (-24.20812685827552, 2.600594648166492, 1.0703666997026744), (27.484962406015043, 3.6785714285714164, 1.1936090225563873), (-25.029146793852675, -55.77106518282989, -49.05458399576047), (25.77296360485269, -57.63084922010398, -50.79809358752166), (-23.509090909090915, -1.9454545454545524, -18.454545454545453), (27.05645161290323, -0.5725806451612954, -18.806451612903224), (-50.03625, -29.291875000000005, -24.519374999999997), (53.37158931082982, -32.13445850914205, -23.737834036568216), (-18.061433447098977, -1.3583617747440258, -1.0443686006825885), (20.921428571428578, -1.057142857142864, -1.085714285714289), (-10.324449594438008, -50.162224797219, -47.251448435689454), (10.190358467243513, -50.75154511742892, -47.62422744128554), (-42.90441932168551, -23.7754367934224, 47.4568345323741), (41.15825268114045, -26.772691603452785, 51.25398901386346), (-21.79166666666667, -35.0, -43.06944444444444), (26.80503144654088, -35.01886792452831, -42.64150943396226), (-10.056657223796037, -77.54900849858356, 5.473087818696882), (15.709833422890924, -74.44922084900591, 8.019344438473937), (-2.3636363636363598, -40.90909090909091, -21.81818181818182), (-6.696148359486443, 35.04992867332382, -19.292439372325248), (8.002684563758393, 34.451006711409406, -19.436241610738257), (-8.398312236286927, -80.5434599156118, 26.17215189873417), (13.122881355932208, -80.70621468926554, 26.871468926553675), (-2.0, -41.282051282051285, -13.333333333333336), (-33.76013166015223, 31.49763423163958, 34.128368648426246), (37.39502058419917, 31.771417369143307, 32.80180356792786), (-8.48628192999054, -56.90192368338063, 47.13213497319458), (9.684436274509807, -57.31188725490196, 42.36519607843137), (-15.359290290783633, -68.6742237555446, -6.274026614095618), (16.077391304347827, -68.14173913043479, -5.215652173913043), (-2.225165562913901, -53.45695364238411, -7.615894039735096), (-5.824790307548923, 34.46598322460392, 12.065237651444548), (-30.885135135135137, 49.1418918918919, -10.986486486486484), (32.894581280788174, 51.27487684729064, -12.141871921182265), (8.117288651942118, 35.72277227722773, 14.432597105864431), (-42.346666666666664, -20.03555555555556, 8.675555555555562), (45.700404858299606, -18.315789473684205, 9.085020242914979), (-2.2409638554216826, -68.24096385542168, -16.16867469879518), (-6.997555012224936, -16.585574572127143, 40.26283618581907), (7.664094416704501, -10.197004085338179, 38.43758511121199), (-53.43554006968641, -22.009581881533094, 5.840592334494772), (57.83253740846865, -23.01050620821394, 5.418656478828396), (-2.473684210526315, -71.63157894736841, -26.842105263157897), (-36.48246546227418, -79.56854410201913, -9.164718384697132), (37.87057633973711, -83.19110212335693, -8.99292214357937), (-6.188295165394408, -44.16793893129771, 22.463104325699746), (7.141141141141148, -43.09309309309309, 20.516516516516518), (-35.410118406889126, 5.440258342303565, 2.1722282023681316), (38.721311475409834, 5.027699265121527, 0.8015828151497999), (-40.15408560311284, 13.867704280155635, -21.436575875486383), (47.937219730941706, 13.45739910313901, -18.1898355754858), (-11.300917431192659, -18.869724770642208, 6.60366972477064), (12.703878902554393, -18.768211920529808, 6.7284768211920465), (-2.1568627450980387, -65.13725490196079, -34.94117647058823), (-8.900000000000006, 13.930769230769243, -13.00769230769231), (10.124567474048447, 14.664359861591691, -12.560553633217992), (-2.631578947368425, -56.89473684210526, -35.31578947368421), (-38.92822695035461, -6.959999999999994, 49.64652482269504), (41.10085773439812, -9.549837326234837, 50.80981958000592), (-2.642857142857139, -46.85714285714286, -33.0), (-23.719961240310084, -60.799418604651166, 57.66375968992247), (25.838811346240433, -60.436740207113914, 60.71949572264745), (-16.756954612005856, -85.61054172767203, 26.853587115666173), (23.963172804532576, -82.20396600566572, 29.284702549575073), (-48.795761078998076, 11.49132947976878, 17.801541425818883), (49.92709077912795, 13.675482487491053, 20.19585418155826)]
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/997/atlas_aal
* func_file : /Users/derekpisner/Applications/PyNets/tests/examples/997/sub-997_ses-01_task-REST_run-01_bold_space-MNI152NLin2009cAsym_preproc_masked.nii.gz
* function_str : def extract_ts_coords(node_size, conf, func_file, coords, dir_path, ID, roi, network, smooth, atlas_select,
                      uatlas_select, label_names, c_boot, block_size, mask):
    import os.path
    from nilearn import input_data
    # from pynets.fmri.estimation import extract_ts_coords_fast
    from pynets import utils
    #from sklearn.externals.joblib import Memory

    if not os.path.isfile(func_file):
        raise ValueError('\nERROR: Functional data input not found! Check that the file(s) specified with the -i flag '
                         'exist(s)')

    if conf:
        if not os.path.isfile(conf):
            raise ValueError('\nERROR: Confound regressor file not found! Check that the file(s) specified with the '
                             '-conf flag exist(s)')

    # if fast is True:
    #     ts_within_nodes = extract_ts_coords_fast(node_size, conf, func_file, coords, dir_path)
    # else:
    detrending = True
    # spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
    #                                                standardize=True, smoothing_fwhm=float(smooth),
    #                                                detrend=detrending,
    #                                                memory=Memory(cachedir="%s%s%s" % (dir_path,
    #                                                                                   '/SpheresMasker_cache_',
    #                                                                                   str(ID)), verbose=2),
    #                                                memory_level=1)
    if len(coords) > 0:
        spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
                                                       standardize=True, smoothing_fwhm=float(smooth),
                                                       detrend=detrending, verbose=2, mask_img=mask)
        # spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
        #                                                standardize=True, verbose=1)
        ts_within_nodes = spheres_masker.fit_transform(func_file, confounds=conf)
        if float(c_boot) > 0:
            print("%s%s%s" % ('Performing circular block bootstrapping iteration: ', c_boot, '...'))
            ts_within_nodes = utils.timeseries_bootstrap(ts_within_nodes, block_size)[0]
        if ts_within_nodes is None:
            raise RuntimeError('\nERROR: Time-series extraction failed!')
    else:
        raise RuntimeError('\nERROR: Cannot extract time-series from an empty list of coordinates. \nThis usually means '
                           'that no nodes were generated based on the specified conditions at runtime (e.g. atlas was '
                           'overly restricted by an RSN or some user-defined mask.')

    print("%s%s%d%s" % ('\nTime series has {0} samples'.format(ts_within_nodes.shape[0]), ' mean extracted from ',
                        len(coords), ' coordinate ROI\'s'))
    print("%s%s%s" % ('Using node radius: ', node_size, ' mm'))
    print("%s%s%s" % ('Smoothing FWHM: ', smooth, ' mm\n'))
    # Save time series as txt file
    utils.save_ts_to_file(roi, network, ID, dir_path, ts_within_nodes, c_boot)
    return ts_within_nodes, node_size, smooth, dir_path, atlas_select, uatlas_select, label_names, coords, c_boot

* label_names : ['Precentral_L', 'Precentral_R', 'Frontal_Sup_L', 'Frontal_Sup_R', 'Frontal_Sup_Orb_L', 'Frontal_Sup_Orb_R', 'Frontal_Mid_L', 'Frontal_Mid_R', 'Frontal_Mid_Orb_L', 'Frontal_Mid_Orb_R', 'Frontal_Inf_Oper_L', 'Frontal_Inf_Oper_R', 'Frontal_Inf_Tri_L', 'Frontal_Inf_Tri_R', 'Frontal_Inf_Orb_L', 'Frontal_Inf_Orb_R', 'Rolandic_Oper_L', 'Rolandic_Oper_R', 'Supp_Motor_Area_L', 'Supp_Motor_Area_R', 'Olfactory_L', 'Olfactory_R', 'Frontal_Sup_Medial_L', 'Frontal_Sup_Medial_R', 'Frontal_Med_Orb_L', 'Frontal_Med_Orb_R', 'Rectus_L', 'Rectus_R', 'Insula_L', 'Insula_R', 'Cingulum_Ant_L', 'Cingulum_Ant_R', 'Cingulum_Mid_L', 'Cingulum_Mid_R', 'Cingulum_Post_L', 'Cingulum_Post_R', 'Hippocampus_L', 'Hippocampus_R', 'ParaHippocampal_L', 'ParaHippocampal_R', 'Amygdala_L', 'Amygdala_R', 'Calcarine_L', 'Calcarine_R', 'Cuneus_L', 'Cuneus_R', 'Lingual_L', 'Lingual_R', 'Occipital_Sup_L', 'Occipital_Sup_R', 'Occipital_Mid_L', 'Occipital_Mid_R', 'Occipital_Inf_L', 'Occipital_Inf_R', 'Fusiform_L', 'Fusiform_R', 'Postcentral_L', 'Postcentral_R', 'Parietal_Sup_L', 'Parietal_Sup_R', 'Parietal_Inf_L', 'Parietal_Inf_R', 'SupraMarginal_L', 'SupraMarginal_R', 'Angular_L', 'Angular_R', 'Precuneus_L', 'Precuneus_R', 'Paracentral_Lobule_L', 'Paracentral_Lobule_R', 'Caudate_L', 'Caudate_R', 'Putamen_L', 'Putamen_R', 'Pallidum_L', 'Pallidum_R', 'Thalamus_L', 'Thalamus_R', 'Heschl_L', 'Heschl_R', 'Temporal_Sup_L', 'Temporal_Sup_R', 'Temporal_Pole_Sup_L', 'Temporal_Pole_Sup_R', 'Temporal_Mid_L', 'Temporal_Mid_R', 'Temporal_Pole_Mid_L', 'Temporal_Pole_Mid_R', 'Temporal_Inf_L', 'Temporal_Inf_R', 'Cerebelum_Crus1_L', 'Cerebelum_Crus1_R', 'Cerebelum_Crus2_L', 'Cerebelum_Crus2_R', 'Cerebelum_3_L', 'Cerebelum_3_R', 'Cerebelum_4_5_L', 'Cerebelum_4_5_R', 'Cerebelum_6_L', 'Cerebelum_6_R', 'Cerebelum_7b_L', 'Cerebelum_7b_R', 'Cerebelum_8_L', 'Cerebelum_8_R', 'Cerebelum_9_L', 'Cerebelum_9_R', 'Cerebelum_10_L', 'Cerebelum_10_R', 'Vermis_1_2', 'Vermis_3', 'Vermis_4_5', 'Vermis_6', 'Vermis_7', 'Vermis_8', 'Vermis_9', 'Vermis_10']
* mask : None
* net_parcels_map_nifti : None
* network : None
* node_size : 4
* roi : None
* smooth : 0
* uatlas_select : /Users/derekpisner/nilearn_data/aal_SPM12/aal/atlas/AAL.nii

Execution Inputs
----------------


* ID : 127
* atlas_select : atlas_aal
* block_size : None
* c_boot : 0
* conf : None
* coords : [(-8.320185614849194, -26.78731631863883, 69.02088167053364), (7.126794258373209, -32.942583732057415, 66.79186602870814), (-25.25536480686695, -21.963519313304715, -11.384120171673821), (28.94503171247358, -20.991543340380545, -11.577167019027485), (-45.890075128509295, 28.666666666666657, 12.582839066824832), (50.061366806136675, 28.901906090190607, 12.817294281729431), (-55.86887899635775, -34.98421691622825, -3.584783488466215), (57.15990020412792, -38.565661147652534, -2.7752324790201897), (-21.492842535787318, -17.29243353783231, -21.918200408997954), (25.148409893992934, -16.300353356890454, -21.743816254416963), (-36.24023668639053, 29.49230769230769, -13.459171597633137), (40.910369068541314, 30.99472759226714, -13.258347978910372), (-36.602666666666664, 13.354666666666674, -35.40533333333333), (43.981418918918905, 13.275337837837839, -33.554054054054056), (-31.39514731369151, -41.36221837088388, -21.61525129982669), (33.6637519872814, -40.16057233704292, -21.546899841017485), (-47.378542510121456, -9.751012145748987, 12.635627530364374), (52.381667918858, -7.537190082644628, 13.32982719759579), (-6.817406143344712, 48.22696245733789, 28.805460750853243), (8.75070290534208, 49.52858481724462, 28.92689784442362), (-35.38532462543219, -67.94314252785247, -30.262773722627735), (38.214501510574024, -68.37160120845923, -30.849697885196377), (-6.527363184079604, 52.25538971807629, -8.762852404643446), (7.834112149532714, 50.406542056074755, -8.516355140186917), (-18.79777158774374, 33.41782729805013, 40.99442896935933), (21.604834731129742, 29.909718796250615, 42.513073507646766), (-28.56786102062975, -74.37133550488599, -39.69055374592834), (32.673594709494566, -70.39678790741615, -41.20170051960321), (-43.10666121781774, -47.01920719248059, 45.42296689824275), (46.291449814126395, -47.58810408921933, 48.19182156133829), (-8.117647058823536, -38.367647058823536, -19.779411764705884), (13.062801932367151, -35.710144927536234, -20.59903381642512), (-16.824506749740394, 45.919003115264786, -14.718587746625133), (18.17853560682046, 46.61785356068205, -15.494483450351055), (-56.146496815286625, -34.93630573248407, 29.119426751592357), (57.27116066903193, -32.82209832742018, 33.13228585909782), (-14.343111111111114, -44.66311111111111, -18.261333333333333), (17.888501742160273, -44.16492450638792, -19.354239256678284), (-44.424914675767916, -62.08532423208191, 34.27815699658703), (45.22831050228311, -61.23858447488584, 37.31506849315069), (-32.639288997854734, -81.99387067116152, 14.788844621513945), (37.10644391408114, -81.00143198090691, 18.095465393794754), (-22.525383707201883, -60.25855962219599, -23.480519480519483), (25.429526462395543, -59.53760445682451, -24.94038997214485), (-11.767151767151773, 9.723492723492711, 8.070686070686065), (14.494969818913475, 10.776659959758547, 8.148893360160969), (-31.585616438356162, -61.078767123287676, -46.763698630136986), (33.928838951310865, -64.40823970037454, -49.760299625468164), (-6.809734513274336, 3.129424778761063, 60.535398230088504), (8.246309574019406, -1.0932096161956935, 60.512863770560955), (-24.20812685827552, 2.600594648166492, 1.0703666997026744), (27.484962406015043, 3.6785714285714164, 1.1936090225563873), (-25.029146793852675, -55.77106518282989, -49.05458399576047), (25.77296360485269, -57.63084922010398, -50.79809358752166), (-23.509090909090915, -1.9454545454545524, -18.454545454545453), (27.05645161290323, -0.5725806451612954, -18.806451612903224), (-50.03625, -29.291875000000005, -24.519374999999997), (53.37158931082982, -32.13445850914205, -23.737834036568216), (-18.061433447098977, -1.3583617747440258, -1.0443686006825885), (20.921428571428578, -1.057142857142864, -1.085714285714289), (-10.324449594438008, -50.162224797219, -47.251448435689454), (10.190358467243513, -50.75154511742892, -47.62422744128554), (-42.90441932168551, -23.7754367934224, 47.4568345323741), (41.15825268114045, -26.772691603452785, 51.25398901386346), (-21.79166666666667, -35.0, -43.06944444444444), (26.80503144654088, -35.01886792452831, -42.64150943396226), (-10.056657223796037, -77.54900849858356, 5.473087818696882), (15.709833422890924, -74.44922084900591, 8.019344438473937), (-2.3636363636363598, -40.90909090909091, -21.81818181818182), (-6.696148359486443, 35.04992867332382, -19.292439372325248), (8.002684563758393, 34.451006711409406, -19.436241610738257), (-8.398312236286927, -80.5434599156118, 26.17215189873417), (13.122881355932208, -80.70621468926554, 26.871468926553675), (-2.0, -41.282051282051285, -13.333333333333336), (-33.76013166015223, 31.49763423163958, 34.128368648426246), (37.39502058419917, 31.771417369143307, 32.80180356792786), (-8.48628192999054, -56.90192368338063, 47.13213497319458), (9.684436274509807, -57.31188725490196, 42.36519607843137), (-15.359290290783633, -68.6742237555446, -6.274026614095618), (16.077391304347827, -68.14173913043479, -5.215652173913043), (-2.225165562913901, -53.45695364238411, -7.615894039735096), (-5.824790307548923, 34.46598322460392, 12.065237651444548), (-30.885135135135137, 49.1418918918919, -10.986486486486484), (32.894581280788174, 51.27487684729064, -12.141871921182265), (8.117288651942118, 35.72277227722773, 14.432597105864431), (-42.346666666666664, -20.03555555555556, 8.675555555555562), (45.700404858299606, -18.315789473684205, 9.085020242914979), (-2.2409638554216826, -68.24096385542168, -16.16867469879518), (-6.997555012224936, -16.585574572127143, 40.26283618581907), (7.664094416704501, -10.197004085338179, 38.43758511121199), (-53.43554006968641, -22.009581881533094, 5.840592334494772), (57.83253740846865, -23.01050620821394, 5.418656478828396), (-2.473684210526315, -71.63157894736841, -26.842105263157897), (-36.48246546227418, -79.56854410201913, -9.164718384697132), (37.87057633973711, -83.19110212335693, -8.99292214357937), (-6.188295165394408, -44.16793893129771, 22.463104325699746), (7.141141141141148, -43.09309309309309, 20.516516516516518), (-35.410118406889126, 5.440258342303565, 2.1722282023681316), (38.721311475409834, 5.027699265121527, 0.8015828151497999), (-40.15408560311284, 13.867704280155635, -21.436575875486383), (47.937219730941706, 13.45739910313901, -18.1898355754858), (-11.300917431192659, -18.869724770642208, 6.60366972477064), (12.703878902554393, -18.768211920529808, 6.7284768211920465), (-2.1568627450980387, -65.13725490196079, -34.94117647058823), (-8.900000000000006, 13.930769230769243, -13.00769230769231), (10.124567474048447, 14.664359861591691, -12.560553633217992), (-2.631578947368425, -56.89473684210526, -35.31578947368421), (-38.92822695035461, -6.959999999999994, 49.64652482269504), (41.10085773439812, -9.549837326234837, 50.80981958000592), (-2.642857142857139, -46.85714285714286, -33.0), (-23.719961240310084, -60.799418604651166, 57.66375968992247), (25.838811346240433, -60.436740207113914, 60.71949572264745), (-16.756954612005856, -85.61054172767203, 26.853587115666173), (23.963172804532576, -82.20396600566572, 29.284702549575073), (-48.795761078998076, 11.49132947976878, 17.801541425818883), (49.92709077912795, 13.675482487491053, 20.19585418155826)]
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/997/atlas_aal
* func_file : /Users/derekpisner/Applications/PyNets/tests/examples/997/sub-997_ses-01_task-REST_run-01_bold_space-MNI152NLin2009cAsym_preproc_masked.nii.gz
* function_str : def extract_ts_coords(node_size, conf, func_file, coords, dir_path, ID, roi, network, smooth, atlas_select,
                      uatlas_select, label_names, c_boot, block_size, mask):
    import os.path
    from nilearn import input_data
    # from pynets.fmri.estimation import extract_ts_coords_fast
    from pynets import utils
    #from sklearn.externals.joblib import Memory

    if not os.path.isfile(func_file):
        raise ValueError('\nERROR: Functional data input not found! Check that the file(s) specified with the -i flag '
                         'exist(s)')

    if conf:
        if not os.path.isfile(conf):
            raise ValueError('\nERROR: Confound regressor file not found! Check that the file(s) specified with the '
                             '-conf flag exist(s)')

    # if fast is True:
    #     ts_within_nodes = extract_ts_coords_fast(node_size, conf, func_file, coords, dir_path)
    # else:
    detrending = True
    # spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
    #                                                standardize=True, smoothing_fwhm=float(smooth),
    #                                                detrend=detrending,
    #                                                memory=Memory(cachedir="%s%s%s" % (dir_path,
    #                                                                                   '/SpheresMasker_cache_',
    #                                                                                   str(ID)), verbose=2),
    #                                                memory_level=1)
    if len(coords) > 0:
        spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
                                                       standardize=True, smoothing_fwhm=float(smooth),
                                                       detrend=detrending, verbose=2, mask_img=mask)
        # spheres_masker = input_data.NiftiSpheresMasker(seeds=coords, radius=float(node_size), allow_overlap=True,
        #                                                standardize=True, verbose=1)
        ts_within_nodes = spheres_masker.fit_transform(func_file, confounds=conf)
        if float(c_boot) > 0:
            print("%s%s%s" % ('Performing circular block bootstrapping iteration: ', c_boot, '...'))
            ts_within_nodes = utils.timeseries_bootstrap(ts_within_nodes, block_size)[0]
        if ts_within_nodes is None:
            raise RuntimeError('\nERROR: Time-series extraction failed!')
    else:
        raise RuntimeError('\nERROR: Cannot extract time-series from an empty list of coordinates. \nThis usually means '
                           'that no nodes were generated based on the specified conditions at runtime (e.g. atlas was '
                           'overly restricted by an RSN or some user-defined mask.')

    print("%s%s%d%s" % ('\nTime series has {0} samples'.format(ts_within_nodes.shape[0]), ' mean extracted from ',
                        len(coords), ' coordinate ROI\'s'))
    print("%s%s%s" % ('Using node radius: ', node_size, ' mm'))
    print("%s%s%s" % ('Smoothing FWHM: ', smooth, ' mm\n'))
    # Save time series as txt file
    utils.save_ts_to_file(roi, network, ID, dir_path, ts_within_nodes, c_boot)
    return ts_within_nodes, node_size, smooth, dir_path, atlas_select, uatlas_select, label_names, coords, c_boot

* label_names : ['Precentral_L', 'Precentral_R', 'Frontal_Sup_L', 'Frontal_Sup_R', 'Frontal_Sup_Orb_L', 'Frontal_Sup_Orb_R', 'Frontal_Mid_L', 'Frontal_Mid_R', 'Frontal_Mid_Orb_L', 'Frontal_Mid_Orb_R', 'Frontal_Inf_Oper_L', 'Frontal_Inf_Oper_R', 'Frontal_Inf_Tri_L', 'Frontal_Inf_Tri_R', 'Frontal_Inf_Orb_L', 'Frontal_Inf_Orb_R', 'Rolandic_Oper_L', 'Rolandic_Oper_R', 'Supp_Motor_Area_L', 'Supp_Motor_Area_R', 'Olfactory_L', 'Olfactory_R', 'Frontal_Sup_Medial_L', 'Frontal_Sup_Medial_R', 'Frontal_Med_Orb_L', 'Frontal_Med_Orb_R', 'Rectus_L', 'Rectus_R', 'Insula_L', 'Insula_R', 'Cingulum_Ant_L', 'Cingulum_Ant_R', 'Cingulum_Mid_L', 'Cingulum_Mid_R', 'Cingulum_Post_L', 'Cingulum_Post_R', 'Hippocampus_L', 'Hippocampus_R', 'ParaHippocampal_L', 'ParaHippocampal_R', 'Amygdala_L', 'Amygdala_R', 'Calcarine_L', 'Calcarine_R', 'Cuneus_L', 'Cuneus_R', 'Lingual_L', 'Lingual_R', 'Occipital_Sup_L', 'Occipital_Sup_R', 'Occipital_Mid_L', 'Occipital_Mid_R', 'Occipital_Inf_L', 'Occipital_Inf_R', 'Fusiform_L', 'Fusiform_R', 'Postcentral_L', 'Postcentral_R', 'Parietal_Sup_L', 'Parietal_Sup_R', 'Parietal_Inf_L', 'Parietal_Inf_R', 'SupraMarginal_L', 'SupraMarginal_R', 'Angular_L', 'Angular_R', 'Precuneus_L', 'Precuneus_R', 'Paracentral_Lobule_L', 'Paracentral_Lobule_R', 'Caudate_L', 'Caudate_R', 'Putamen_L', 'Putamen_R', 'Pallidum_L', 'Pallidum_R', 'Thalamus_L', 'Thalamus_R', 'Heschl_L', 'Heschl_R', 'Temporal_Sup_L', 'Temporal_Sup_R', 'Temporal_Pole_Sup_L', 'Temporal_Pole_Sup_R', 'Temporal_Mid_L', 'Temporal_Mid_R', 'Temporal_Pole_Mid_L', 'Temporal_Pole_Mid_R', 'Temporal_Inf_L', 'Temporal_Inf_R', 'Cerebelum_Crus1_L', 'Cerebelum_Crus1_R', 'Cerebelum_Crus2_L', 'Cerebelum_Crus2_R', 'Cerebelum_3_L', 'Cerebelum_3_R', 'Cerebelum_4_5_L', 'Cerebelum_4_5_R', 'Cerebelum_6_L', 'Cerebelum_6_R', 'Cerebelum_7b_L', 'Cerebelum_7b_R', 'Cerebelum_8_L', 'Cerebelum_8_R', 'Cerebelum_9_L', 'Cerebelum_9_R', 'Cerebelum_10_L', 'Cerebelum_10_R', 'Vermis_1_2', 'Vermis_3', 'Vermis_4_5', 'Vermis_6', 'Vermis_7', 'Vermis_8', 'Vermis_9', 'Vermis_10']
* mask : None
* net_parcels_map_nifti : None
* network : None
* node_size : 4
* roi : None
* smooth : 0
* uatlas_select : /Users/derekpisner/nilearn_data/aal_SPM12/aal/atlas/AAL.nii


Execution Outputs
-----------------


* atlas_select : atlas_aal
* c_boot : 0
* coords : [(-8.320185614849194, -26.78731631863883, 69.02088167053364), (7.126794258373209, -32.942583732057415, 66.79186602870814), (-25.25536480686695, -21.963519313304715, -11.384120171673821), (28.94503171247358, -20.991543340380545, -11.577167019027485), (-45.890075128509295, 28.666666666666657, 12.582839066824832), (50.061366806136675, 28.901906090190607, 12.817294281729431), (-55.86887899635775, -34.98421691622825, -3.584783488466215), (57.15990020412792, -38.565661147652534, -2.7752324790201897), (-21.492842535787318, -17.29243353783231, -21.918200408997954), (25.148409893992934, -16.300353356890454, -21.743816254416963), (-36.24023668639053, 29.49230769230769, -13.459171597633137), (40.910369068541314, 30.99472759226714, -13.258347978910372), (-36.602666666666664, 13.354666666666674, -35.40533333333333), (43.981418918918905, 13.275337837837839, -33.554054054054056), (-31.39514731369151, -41.36221837088388, -21.61525129982669), (33.6637519872814, -40.16057233704292, -21.546899841017485), (-47.378542510121456, -9.751012145748987, 12.635627530364374), (52.381667918858, -7.537190082644628, 13.32982719759579), (-6.817406143344712, 48.22696245733789, 28.805460750853243), (8.75070290534208, 49.52858481724462, 28.92689784442362), (-35.38532462543219, -67.94314252785247, -30.262773722627735), (38.214501510574024, -68.37160120845923, -30.849697885196377), (-6.527363184079604, 52.25538971807629, -8.762852404643446), (7.834112149532714, 50.406542056074755, -8.516355140186917), (-18.79777158774374, 33.41782729805013, 40.99442896935933), (21.604834731129742, 29.909718796250615, 42.513073507646766), (-28.56786102062975, -74.37133550488599, -39.69055374592834), (32.673594709494566, -70.39678790741615, -41.20170051960321), (-43.10666121781774, -47.01920719248059, 45.42296689824275), (46.291449814126395, -47.58810408921933, 48.19182156133829), (-8.117647058823536, -38.367647058823536, -19.779411764705884), (13.062801932367151, -35.710144927536234, -20.59903381642512), (-16.824506749740394, 45.919003115264786, -14.718587746625133), (18.17853560682046, 46.61785356068205, -15.494483450351055), (-56.146496815286625, -34.93630573248407, 29.119426751592357), (57.27116066903193, -32.82209832742018, 33.13228585909782), (-14.343111111111114, -44.66311111111111, -18.261333333333333), (17.888501742160273, -44.16492450638792, -19.354239256678284), (-44.424914675767916, -62.08532423208191, 34.27815699658703), (45.22831050228311, -61.23858447488584, 37.31506849315069), (-32.639288997854734, -81.99387067116152, 14.788844621513945), (37.10644391408114, -81.00143198090691, 18.095465393794754), (-22.525383707201883, -60.25855962219599, -23.480519480519483), (25.429526462395543, -59.53760445682451, -24.94038997214485), (-11.767151767151773, 9.723492723492711, 8.070686070686065), (14.494969818913475, 10.776659959758547, 8.148893360160969), (-31.585616438356162, -61.078767123287676, -46.763698630136986), (33.928838951310865, -64.40823970037454, -49.760299625468164), (-6.809734513274336, 3.129424778761063, 60.535398230088504), (8.246309574019406, -1.0932096161956935, 60.512863770560955), (-24.20812685827552, 2.600594648166492, 1.0703666997026744), (27.484962406015043, 3.6785714285714164, 1.1936090225563873), (-25.029146793852675, -55.77106518282989, -49.05458399576047), (25.77296360485269, -57.63084922010398, -50.79809358752166), (-23.509090909090915, -1.9454545454545524, -18.454545454545453), (27.05645161290323, -0.5725806451612954, -18.806451612903224), (-50.03625, -29.291875000000005, -24.519374999999997), (53.37158931082982, -32.13445850914205, -23.737834036568216), (-18.061433447098977, -1.3583617747440258, -1.0443686006825885), (20.921428571428578, -1.057142857142864, -1.085714285714289), (-10.324449594438008, -50.162224797219, -47.251448435689454), (10.190358467243513, -50.75154511742892, -47.62422744128554), (-42.90441932168551, -23.7754367934224, 47.4568345323741), (41.15825268114045, -26.772691603452785, 51.25398901386346), (-21.79166666666667, -35.0, -43.06944444444444), (26.80503144654088, -35.01886792452831, -42.64150943396226), (-10.056657223796037, -77.54900849858356, 5.473087818696882), (15.709833422890924, -74.44922084900591, 8.019344438473937), (-2.3636363636363598, -40.90909090909091, -21.81818181818182), (-6.696148359486443, 35.04992867332382, -19.292439372325248), (8.002684563758393, 34.451006711409406, -19.436241610738257), (-8.398312236286927, -80.5434599156118, 26.17215189873417), (13.122881355932208, -80.70621468926554, 26.871468926553675), (-2.0, -41.282051282051285, -13.333333333333336), (-33.76013166015223, 31.49763423163958, 34.128368648426246), (37.39502058419917, 31.771417369143307, 32.80180356792786), (-8.48628192999054, -56.90192368338063, 47.13213497319458), (9.684436274509807, -57.31188725490196, 42.36519607843137), (-15.359290290783633, -68.6742237555446, -6.274026614095618), (16.077391304347827, -68.14173913043479, -5.215652173913043), (-2.225165562913901, -53.45695364238411, -7.615894039735096), (-5.824790307548923, 34.46598322460392, 12.065237651444548), (-30.885135135135137, 49.1418918918919, -10.986486486486484), (32.894581280788174, 51.27487684729064, -12.141871921182265), (8.117288651942118, 35.72277227722773, 14.432597105864431), (-42.346666666666664, -20.03555555555556, 8.675555555555562), (45.700404858299606, -18.315789473684205, 9.085020242914979), (-2.2409638554216826, -68.24096385542168, -16.16867469879518), (-6.997555012224936, -16.585574572127143, 40.26283618581907), (7.664094416704501, -10.197004085338179, 38.43758511121199), (-53.43554006968641, -22.009581881533094, 5.840592334494772), (57.83253740846865, -23.01050620821394, 5.418656478828396), (-2.473684210526315, -71.63157894736841, -26.842105263157897), (-36.48246546227418, -79.56854410201913, -9.164718384697132), (37.87057633973711, -83.19110212335693, -8.99292214357937), (-6.188295165394408, -44.16793893129771, 22.463104325699746), (7.141141141141148, -43.09309309309309, 20.516516516516518), (-35.410118406889126, 5.440258342303565, 2.1722282023681316), (38.721311475409834, 5.027699265121527, 0.8015828151497999), (-40.15408560311284, 13.867704280155635, -21.436575875486383), (47.937219730941706, 13.45739910313901, -18.1898355754858), (-11.300917431192659, -18.869724770642208, 6.60366972477064), (12.703878902554393, -18.768211920529808, 6.7284768211920465), (-2.1568627450980387, -65.13725490196079, -34.94117647058823), (-8.900000000000006, 13.930769230769243, -13.00769230769231), (10.124567474048447, 14.664359861591691, -12.560553633217992), (-2.631578947368425, -56.89473684210526, -35.31578947368421), (-38.92822695035461, -6.959999999999994, 49.64652482269504), (41.10085773439812, -9.549837326234837, 50.80981958000592), (-2.642857142857139, -46.85714285714286, -33.0), (-23.719961240310084, -60.799418604651166, 57.66375968992247), (25.838811346240433, -60.436740207113914, 60.71949572264745), (-16.756954612005856, -85.61054172767203, 26.853587115666173), (23.963172804532576, -82.20396600566572, 29.284702549575073), (-48.795761078998076, 11.49132947976878, 17.801541425818883), (49.92709077912795, 13.675482487491053, 20.19585418155826)]
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/997/atlas_aal
* label_names : ['Precentral_L', 'Precentral_R', 'Frontal_Sup_L', 'Frontal_Sup_R', 'Frontal_Sup_Orb_L', 'Frontal_Sup_Orb_R', 'Frontal_Mid_L', 'Frontal_Mid_R', 'Frontal_Mid_Orb_L', 'Frontal_Mid_Orb_R', 'Frontal_Inf_Oper_L', 'Frontal_Inf_Oper_R', 'Frontal_Inf_Tri_L', 'Frontal_Inf_Tri_R', 'Frontal_Inf_Orb_L', 'Frontal_Inf_Orb_R', 'Rolandic_Oper_L', 'Rolandic_Oper_R', 'Supp_Motor_Area_L', 'Supp_Motor_Area_R', 'Olfactory_L', 'Olfactory_R', 'Frontal_Sup_Medial_L', 'Frontal_Sup_Medial_R', 'Frontal_Med_Orb_L', 'Frontal_Med_Orb_R', 'Rectus_L', 'Rectus_R', 'Insula_L', 'Insula_R', 'Cingulum_Ant_L', 'Cingulum_Ant_R', 'Cingulum_Mid_L', 'Cingulum_Mid_R', 'Cingulum_Post_L', 'Cingulum_Post_R', 'Hippocampus_L', 'Hippocampus_R', 'ParaHippocampal_L', 'ParaHippocampal_R', 'Amygdala_L', 'Amygdala_R', 'Calcarine_L', 'Calcarine_R', 'Cuneus_L', 'Cuneus_R', 'Lingual_L', 'Lingual_R', 'Occipital_Sup_L', 'Occipital_Sup_R', 'Occipital_Mid_L', 'Occipital_Mid_R', 'Occipital_Inf_L', 'Occipital_Inf_R', 'Fusiform_L', 'Fusiform_R', 'Postcentral_L', 'Postcentral_R', 'Parietal_Sup_L', 'Parietal_Sup_R', 'Parietal_Inf_L', 'Parietal_Inf_R', 'SupraMarginal_L', 'SupraMarginal_R', 'Angular_L', 'Angular_R', 'Precuneus_L', 'Precuneus_R', 'Paracentral_Lobule_L', 'Paracentral_Lobule_R', 'Caudate_L', 'Caudate_R', 'Putamen_L', 'Putamen_R', 'Pallidum_L', 'Pallidum_R', 'Thalamus_L', 'Thalamus_R', 'Heschl_L', 'Heschl_R', 'Temporal_Sup_L', 'Temporal_Sup_R', 'Temporal_Pole_Sup_L', 'Temporal_Pole_Sup_R', 'Temporal_Mid_L', 'Temporal_Mid_R', 'Temporal_Pole_Mid_L', 'Temporal_Pole_Mid_R', 'Temporal_Inf_L', 'Temporal_Inf_R', 'Cerebelum_Crus1_L', 'Cerebelum_Crus1_R', 'Cerebelum_Crus2_L', 'Cerebelum_Crus2_R', 'Cerebelum_3_L', 'Cerebelum_3_R', 'Cerebelum_4_5_L', 'Cerebelum_4_5_R', 'Cerebelum_6_L', 'Cerebelum_6_R', 'Cerebelum_7b_L', 'Cerebelum_7b_R', 'Cerebelum_8_L', 'Cerebelum_8_R', 'Cerebelum_9_L', 'Cerebelum_9_R', 'Cerebelum_10_L', 'Cerebelum_10_R', 'Vermis_1_2', 'Vermis_3', 'Vermis_4_5', 'Vermis_6', 'Vermis_7', 'Vermis_8', 'Vermis_9', 'Vermis_10']
* node_size : 4
* smooth : 0
* ts_within_nodes : [[ 0.21271189 -0.9816183  -2.0468237  ...  1.3065121   0.63518417
   0.3933397 ]
 [-0.48367202  0.47279283  0.1912865  ... -0.29603896  0.6095288
   0.9284861 ]
 [ 0.18839064 -0.9216517  -0.8619707  ... -0.31567624 -1.2928486
   1.0017871 ]
 ...
 [-0.10708141 -0.06490935 -0.66172117 ...  0.34618643  0.63896394
   0.6177307 ]
 [ 0.36511347  1.2283473   1.1310766  ... -1.9178196   1.122112
   0.9148985 ]
 [ 2.0250428  -0.83102155 -1.2572722  ...  0.36165065 -1.355625
   0.954857  ]]
* uatlas_select : /Users/derekpisner/nilearn_data/aal_SPM12/aal/atlas/AAL.nii


Runtime info
------------


* duration : 49.091468
* hostname : dpys
* prev_wd : /Users/derekpisner/Applications/PyNets
* working_dir : /Users/derekpisner/Applications/PyNets/tests/examples/997/Wf_single_subject_127/Wf_single_sub_127_57/Meta_wf_127/functional_connectometry_127/extract_ts_node


Environment
~~~~~~~~~~~


* ANTSPATH : /Users/derekpisner/bin/ants/bin/
* Apple_PubSub_Socket_Render : /private/tmp/com.apple.launchd.LEz8QPGeOM/Render
* CONDA_DEFAULT_ENV : base
* CONDA_EXE : /usr/local/anaconda3/bin/conda
* CONDA_PREFIX : /usr/local/anaconda3
* CONDA_PROMPT_MODIFIER : (base) 
* CONDA_SHLVL : 1
* CPPFLAGS : -I/usr/local/opt/libxml2/include
* DYLD_LIBRARY_PATH : /Applications/freesurfer/lib/gcc/lib::/opt/X11/lib/flat_namespace
* FIX_VERTEX_AREA : 
* FMRI_ANALYSIS_DIR : /Applications/freesurfer/fsfast
* FREESURFER_HOME : /Applications/freesurfer
* FSFAST_HOME : /Applications/freesurfer/fsfast
* FSF_OUTPUT_FORMAT : nii.gz
* FSLDIR : /usr/local/fsl
* FSLGECUDAQ : cuda.q
* FSLLOCKDIR : 
* FSLMACHINELIST : 
* FSLMULTIFILEQUIT : TRUE
* FSLOUTPUTTYPE : NIFTI_GZ
* FSLREMOTECALL : 
* FSLTCLSH : /usr/local/fsl/bin/fsltclsh
* FSLWISH : /usr/local/fsl/bin/fslwish
* FSL_BIN : /usr/local/fsl/bin
* FSL_DIR : /usr/local/fsl
* FS_OVERRIDE : 0
* FUNCTIONALS_DIR : /Applications/freesurfer/sessions
* HOME : /Users/derekpisner
* LANG : en_US.UTF-8
* LDFLAGS : -L/usr/local/opt/libxml2/lib
* LOCAL_DIR : /Applications/freesurfer/local
* LOGNAME : derekpisner
* MINC_BIN_DIR : /Applications/freesurfer/mni/bin
* MINC_LIB_DIR : /Applications/freesurfer/mni/lib
* MNI_DATAPATH : /Applications/freesurfer/mni/data
* MNI_DIR : /Applications/freesurfer/mni
* MNI_PERL5LIB : /Applications/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* OLDPWD : /Users/derekpisner
* OS : Darwin
* PATH : /Users/derekpisner/bin/ants/bin/:/usr/local/opt/libxml2/bin:/Applications/freesurfer/bin:/Applications/freesurfer/fsfast/bin:/Applications/freesurfer/tktools:/usr/local/fsl/bin:/Applications/freesurfer/mni/bin:/usr/local/fsl/bin:/usr/local/anaconda3/bin:/usr/local/anaconda3/condabin:/Users/derekpisner/anaconda3/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin:/Users/derekpisner/abin
* PERL5LIB : /Applications/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* PWD : /Users/derekpisner/Applications/PyNets
* SHELL : /bin/bash
* SHLVL : 2
* SSH_AUTH_SOCK : /private/tmp/com.apple.launchd.0lGeOlHWzb/Listeners
* SUBJECTS_DIR : /Applications/freesurfer/subjects
* TERM : xterm-256color
* TERM_PROGRAM : Apple_Terminal
* TERM_PROGRAM_VERSION : 421.1.1
* TERM_SESSION_ID : FE8A7C24-4E2F-49CF-AFB1-E40646E27050
* TMPDIR : /var/folders/r1/p8kclf5j3v74m4l5l4__jty00000gn/T/
* USER : derekpisner
* XPC_FLAGS : 0x0
* XPC_SERVICE_NAME : 0
* _ : /usr/local/anaconda3/bin/pynets_run.py
* _CE_CONDA : 
* _CE_M : 
* __CF_USER_TEXT_ENCODING : 0x1F5:0x0:0x0

